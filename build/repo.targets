<Project>

  <ItemGroup>
    <!-- Exclude benchmark projects on CI builds unless IsBuildingBenchmarks is true. -->
    <Solutions Update="$(RepositoryRoot)EFCore.sln" Condition=" '$(IsBuildingBenchmarks)' != 'true' ">
      <AdditionalProperties>Configuration=$(Configuration)NoBenchmarks</AdditionalProperties>
    </Solutions>
  </ItemGroup>

  <Target Name="_FilterTestProjects" BeforeTargets="TestProjects">
    <ItemGroup Condition="'$(TestFilter)' != ''">
      <ProjectsToTest Remove="@(ProjectsToTest)"/>
      <ProjectsToTest Include="$(RepositoryRoot)test\*$(TestFilter)*\*.csproj" Exclude="@(ExcludeFromTest)" />
    </ItemGroup>

    <Error Text="Could not find test projects to run" Condition="@(ProjectsToTest->Count()) == 0" />
  </Target>
</Project>
